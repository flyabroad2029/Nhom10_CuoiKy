<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M-Chat</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="image/logo.png">
</head>
<body>

    <div class="login" id="login">
        <div class="bg-circles">
            <div class="circle-1"></div>
            <div class="circle-2"></div>
        </div>
    
        <div class="login-card">
            <div class="card-header">
                <h2>üí¨ M - Chat</h2>
                <p>H·ªÜ TH·ªêNG TR√í CHUY·ªÜN TH·ªúI GIAN TH·ª∞C ƒêA PH√íNG</p>
            </div>
            
            <div class="avatar-section">
                <label style="color: orange;">Ch·ªçn ·∫£nh ƒë·∫°i di·ªán c·ªßa b·∫°n</label>
                <div class="avatar-selector" id="avatarSelector"></div>
            </div>
    
            <div class="input-group">
                <input id="username" placeholder="T√™n hi·ªÉn th·ªã" maxlength="15">
                <input id="roomId" placeholder="ID Ph√≤ng" maxlength="15">
                <input id="roomPass" type="password" placeholder="M·∫≠t kh·∫©u">
            </div>
    
            <button type="button" class="btn-login" onclick="login()">
                <span>Tham gia ngay</span>
            </button>
        </div>
    </div>

<div class="app" id="app" style="display:none;">
    <div class="app-container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h3 id="roomDisplay">Ph√≤ng: ---</h3>
                <span class="online-count" id="onlineCount">0</span>
            </div>
            <div class="user-list" id="userList"></div>
        </div>

        <div class="chat-area">
            <div class="chat-header">
                <button id="menu-btn" class="menu-btn" onclick="toggleSidebar()">
                    <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
                </button>
            
                <h2 id="chatTitle">K√™nh Chat Chung</h2>
                
                <div style="display: flex; gap: 10px; align-items: center;">
                    <button onclick="startCall()" class="header-action-btn call-btn">üìû <span class="btn-text">G·ªçi</span></button>
                    <button onclick="outRoom()" class="header-action-btn exit-btn">üö™ <span class="btn-text">Tho√°t</span></button>
                </div>
            </div>
            
            <div id="sidebar-overlay" class="sidebar-overlay" onclick="toggleSidebar()"></div>
            <div class="messages" id="messages"></div>
            
            <div class="input-area">
                <div class="reply-bar" id="replyBar">
                    <div class="reply-info">
                        <div class="reply-to">ƒêang tr·∫£ l·ªùi <span id="replyToUser"></span></div>
                        <div class="reply-text" id="replyToText"></div>
                    </div>
                    <div class="reply-close" onclick="cancelReply()">√ó</div>
                </div>
                <div class="input-box">
                    <input id="msg" placeholder="Nh·∫≠p tin nh·∫Øn..." onkeydown="enterSend(event)">
                    <button type="button" onclick="send()">‚û§</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="callPopup" style="display:none; position:fixed; top:20px; left:50%; transform:translateX(-50%); background:white; padding:20px; border-radius:15px; box-shadow:0 10px 40px rgba(0,0,0,0.3); z-index:9999; text-align:center; border:2px solid #27ae60;">
    <h3 id="callMsg">ƒêang c√≥ cu·ªôc g·ªçi...</h3>
    <div style="display:flex; gap:10px; justify-content:center; margin-top:15px;">
        <button onclick="acceptCall()" style="background:#27ae60; color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer; font-weight:bold;">ƒê·ªìng √Ω</button>
        <button onclick="rejectCall()" style="background:#e74c3c; color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer; font-weight:bold;">T·ª´ ch·ªëi</button>
    </div>
</div>

<div id="videoContainer" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); background:rgba(0,0,0,0.95); width:90%; max-width:800px; padding:20px; border-radius:20px; z-index:1000; flex-direction:column; align-items:center;">
    <video id="localVideo" autoplay muted playsinline style="width:100%; max-height:400px; border-radius:10px; background:#222;"></video>
    
    <div style="display: flex; gap: 15px; margin-top: 20px;">
        <button id="toggleMic" onclick="toggleMic()" style="background: #444; color: white; border: none; padding: 10px 20px; border-radius: 10px; cursor: pointer; font-weight: bold; min-width: 120px;">
            üéôÔ∏è Mic: B·∫≠t
        </button>
        
        <button id="toggleCam" onclick="toggleCam()" style="background: #444; color: white; border: none; padding: 10px 20px; border-radius: 10px; cursor: pointer; font-weight: bold; min-width: 120px;">
            üì∑ Cam: B·∫≠t
        </button>
        
        <button onclick="endCall()" style="background:#e74c3c; color:white; border:none; padding:12px 30px; border-radius:30px; font-weight:bold; cursor:pointer;">
            G√°c m√°y üìµ
        </button>
    </div>
</div>

<div class="emoji-picker" id="emojiPicker"></div>
<script src="script.js"></script>
</body>
</html>