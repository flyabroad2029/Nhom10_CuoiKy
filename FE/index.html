<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M-Chat</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="image/logo.png">
</head>
<body>

    <div class="login" id="login">
        <div class="bg-circles">
            <div class="circle-1"></div>
            <div class="circle-2"></div>
        </div>
    
        <div class="login-card">
            <div class="card-header">
                <h2>üí¨ M - Chat</h2>
                <p>H·ªÜ TH·ªêNG TR√í CHUY·ªÜN TH·ªúI GIAN TH·ª∞C ƒêA PH√íNG</p>
            </div>
            
            <div class="avatar-section">
                <label style="color: orange;">Ch·ªçn ·∫£nh ƒë·∫°i di·ªán c·ªßa b·∫°n</label>
                <div class="avatar-selector" id="avatarSelector"></div>
            </div>
    
            <div class="input-group">
                <input id="username" placeholder="T√™n hi·ªÉn th·ªã" maxlength="15">
                <input id="roomId" placeholder="ID Ph√≤ng" maxlength="15">
                <input id="roomPass" type="password" placeholder="M·∫≠t kh·∫©u">
            </div>
    
            <button type="button" class="btn-login" onclick="login()">
                <span>Tham gia ngay</span>
            </button>
        </div>
    </div>

<div class="app" id="app" style="display:none;">
    <div class="app-container">
        <div class="sidebar">
            <div class="sidebar-header">
                <h3 id="roomDisplay">Ph√≤ng: ---</h3>
                <span class="online-count" id="onlineCount">0</span>
            </div>
            <div class="user-list" id="userList"></div>
        </div>

        <div class="chat-area">
            <div class="chat-header">
                <button id="menu-btn" class="menu-btn" onclick="toggleSidebar()">
                    <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
                </button>
            
                <h2 id="chatTitle">K√™nh Chat Chung</h2>
                
                <div style="display: flex; gap: 12px; align-items: center;">
                    <button onclick="startCall()" 
                            class="header-action-btn call-btn" 
                            style="display: flex; align-items: center; gap: 6px; background-color: #27ae60; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.2s ease; box-shadow: 0 2px 5px rgba(39, 174, 96, 0.3);"
                            onmouseover="this.style.backgroundColor='#2ecc71'; this.style.transform='translateY(-1px)'"
                            onmouseout="this.style.backgroundColor='#27ae60'; this.style.transform='translateY(0)'">
                        üìû <span class="btn-text">G·ªçi</span>
                    </button>
                
                    <button onclick="outRoom()" 
                            class="header-action-btn exit-btn" 
                            style="display: flex; align-items: center; gap: 6px; background-color: #e74c3c; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.2s ease; box-shadow: 0 2px 5px rgba(231, 76, 60, 0.3);"
                            onmouseover="this.style.backgroundColor='#ff7675'; this.style.transform='translateY(-1px)'"
                            onmouseout="this.style.backgroundColor='#e74c3c'; this.style.transform='translateY(0)'">
                        üö™ <span class="btn-text">Tho√°t</span>
                    </button>
                </div>
            </div>
            
            <div id="sidebar-overlay" class="sidebar-overlay" onclick="toggleSidebar()"></div>
            <div class="messages" id="messages"></div>
            
            <div class="input-area">
                <div class="reply-bar" id="replyBar">
                    <div class="reply-info">
                        <div class="reply-to">ƒêang tr·∫£ l·ªùi <span id="replyToUser"></span></div>
                        <div class="reply-text" id="replyToText"></div>
                    </div>
                    <div class="reply-close" onclick="cancelReply()">√ó</div>
                </div>
                <div class="input-box">
                    <input id="msg" placeholder="Nh·∫≠p tin nh·∫Øn..." onkeydown="enterSend(event)">
                    <button type="button" onclick="send()">‚û§</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="callPopup" style="display:none; position:fixed; top:20px; left:50%; transform:translateX(-50%); background:white; padding:20px; border-radius:15px; box-shadow:0 10px 40px rgba(0,0,0,0.3); z-index:9999; text-align:center; border:2px solid #27ae60;">
    <h3 id="callMsg">ƒêang c√≥ cu·ªôc g·ªçi...</h3>
    <div style="display:flex; gap:10px; justify-content:center; margin-top:15px;">
        <button onclick="acceptCall()" style="background:#27ae60; color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer; font-weight:bold;">ƒê·ªìng √Ω</button>
        <button onclick="rejectCall()" style="background:#e74c3c; color:white; border:none; padding:10px 20px; border-radius:5px; cursor:pointer; font-weight:bold;">T·ª´ ch·ªëi</button>
    </div>
</div>

<div id="videoContainer" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); background:rgba(20,20,20,0.98); width:95%; max-width:900px; padding:20px; border-radius:24px; z-index:1000; flex-direction:column; align-items:center; box-shadow: 0 20px 50px rgba(0,0,0,0.5); border: 1px solid #333;">
    
    <div style="position: relative; width: 100%; aspect-ratio: 16/9; background: #000; border-radius: 15px; overflow: hidden;">
        <video id="remoteVideo" autoplay playsinline style="width: 100%; height: 100%; object-fit: cover;"></video>
        
        <video id="localVideo" autoplay muted playsinline style="position: absolute; top: 15px; right: 15px; width: 25%; max-width: 200px; border-radius: 10px; border: 2px solid #4ade80; background: #222; box-shadow: 0 4px 15px rgba(0,0,0,0.3);"></video>
    </div>

    <div style="display: flex; gap: 15px; margin-top: 25px; flex-wrap: wrap; justify-content: center;">
        <button id="toggleMic" onclick="toggleMic()" style="background: #333; color: white; border: 1px solid #444; padding: 12px 20px; border-radius: 12px; cursor: pointer; font-weight: bold; min-width: 130px; transition: 0.3s;">
            üéôÔ∏è Mic: B·∫≠t
        </button>
        
        <button id="toggleCam" onclick="toggleCam()" style="background: #333; color: white; border: 1px solid #444; padding: 12px 20px; border-radius: 12px; cursor: pointer; font-weight: bold; min-width: 130px; transition: 0.3s;">
            üì∑ Cam: B·∫≠t
        </button>
        
        <button onclick="endCall()" style="background: #ff4757; color: white; border: none; padding: 12px 35px; border-radius: 30px; font-weight: bold; cursor: pointer; box-shadow: 0 5px 15px rgba(255, 71, 87, 0.4); transition: 0.3s;">
            G√°c m√°y üìµ
        </button>
    </div>
</div>

<div class="emoji-picker" id="emojiPicker"></div>
<script src="script.js"></script>
</body>
</html>